<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRE Vocabulary Flashcards</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        /* Dashboard Styles */
        .dashboard {
            display: block;
        }

        .deck-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .deck-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            color: #333;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .deck-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .deck-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .deck-progress {
            margin-bottom: 20px;
        }

        .progress-text {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 8px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #ecf0f1;
            border-radius: 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #4CAF50;
            border-radius: 6px;
            transition: width 0.3s ease;
        }

        .practice-btn {
            width: 100%;
            padding: 12px;
            background: transparent;
            border: 2px solid #3498db;
            color: #3498db;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .practice-btn:hover {
            background: #3498db;
            color: white;
        }

        /* Study Mode Styles */
        .study-mode {
            display: none;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .settings {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings h3 {
            margin-bottom: 15px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .setting-item label {
            min-width: 200px;
        }

        .setting-item input {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            width: 80px;
        }

        .progress-section {
            margin-bottom: 30px;
        }

        .progress-item {
            margin-bottom: 15px;
        }

        .progress-label {
            font-size: 14px;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }

        .progress-bar-study {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill-study {
            height: 100%;
            transition: width 0.3s ease;
        }

        .mastered {
            background: #4CAF50;
        }

        .reviewing {
            background: #FF9800;
        }

        .learning {
            background: #F44336;
        }

        .flashcard-container {
            perspective: 1000px;
            margin-bottom: 30px;
        }

        .flashcard {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            color: #333;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s ease;
            position: relative;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .flashcard:hover {
            transform: translateY(-5px);
        }

        .word {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .meaning {
            font-size: 1.5em;
            color: #7f8c8d;
            font-style: italic;
        }

        .flip-hint {
            position: absolute;
            bottom: 15px;
            right: 15px;
            font-size: 12px;
            color: #bdc3c7;
        }

        .definition-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .definition-btn:hover {
            background: #2980b9;
            transform: scale(1.05);
        }

        .definition-content {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            text-align: left;
            font-size: 14px;
            line-height: 1.5;
            color: #2c3e50;
            max-height: 200px;
            overflow-y: auto;
        }

        .definition-content h4 {
            margin: 0 0 10px 0;
            color: #2980b9;
            font-size: 16px;
        }

        .definition-loading {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
        }

        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .btn-know {
            background: #4CAF50;
            color: white;
        }

        .btn-know:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-dont-know {
            background: #F44336;
            color: white;
        }

        .btn-dont-know:hover {
            background: #da190b;
            transform: translateY(-2px);
        }

        .no-words {
            text-align: center;
            font-size: 1.5em;
            color: #ecf0f1;
            margin-top: 50px;
        }

        @media (max-width: 768px) {
            .deck-grid {
                grid-template-columns: 1fr;
            }

            .buttons {
                flex-direction: column;
                align-items: center;
            }

            .word {
                font-size: 2em;
            }

            .setting-item {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üìö GRE Vocabulary Flashcards</h1>
        </div>

        <!-- Dashboard View -->
        <div id="dashboard" class="dashboard">
            <div class="deck-grid" id="deckGrid">
                <!-- Deck cards will be generated here -->
            </div>
        </div>

        <!-- Study Mode View -->
        <div id="studyMode" class="study-mode">
            <button class="back-btn" id="backBtn">‚Üê Back to Dashboard</button>

            
            <div id="flashcardSection">
                <div class="flashcard-container">
                    <div class="flashcard" id="flashcard">
                        <button class="definition-btn" id="definitionBtn">Get Definition</button>
                        <div class="word" id="wordDisplay"></div>
                        <div class="meaning" id="meaningDisplay" style="display: none;"></div>
                        <div id="definitionContent" class="definition-content" style="display: none;"></div>
                        <div class="flip-hint">Click to flip</div>
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn btn-know" id="knowBtn" style="display: none;">‚úì I know this word</button>
                    <button class="btn btn-dont-know" id="dontKnowBtn" style="display: none;">‚úó I don't know this
                        word</button>
                </div>
            </div>

            <div id="noWordsMessage" class="no-words" style="display: none;">
                üéâ Congratulations! You've mastered all words in this list!
            </div>

            <div class="progress-section">
                <div class="progress-item">
                    <div class="progress-label">
                        <span>You have mastered <span id="masteredCount">0</span> out of <span id="totalWords">0</span>
                            words</span>
                    </div>
                    <div class="progress-bar-study">
                        <div class="progress-fill-study mastered" id="masteredProgress"></div>
                    </div>
                </div>

                <div class="progress-item">
                    <div class="progress-label">
                        <span>You are reviewing <span id="reviewingCount">0</span> out of <span
                                id="totalWords2">0</span> words</span>
                    </div>
                    <div class="progress-bar-study">
                        <div class="progress-fill-study reviewing" id="reviewingProgress"></div>
                    </div>
                </div>

                <div class="progress-item">
                    <div class="progress-label">
                        <span>You are learning <span id="learningCount">0</span> out of <span id="totalWords3">0</span>
                            words</span>
                    </div>
                    <div class="progress-bar-study">
                        <div class="progress-fill-study learning" id="learningProgress"></div>
                    </div>
                </div>
            </div>

            <div class="settings">
                <h3>Settings</h3>
                <div class="setting-item">
                    <label>Active words in rotation (N):</label>
                    <input type="number" id="maxActiveWords" value="10" min="5" max="20">
                </div>
                <div class="setting-item">
                    <label>Times correct to master:</label>
                    <input type="number" id="masteryThreshold" value="3" min="2" max="5">
                </div>
            </div>


        </div>
    </div>

    <script>
        // Configuration - Using a simplified key-value pair structure for words.
        const WORD_LISTS = {
            "List 1": [
{ word: '*FECKLESS (irresponsible)',meaning:'INEFFECTIVE'},{ word: 'ADEPT',meaning:'SKILLFUL'},{ word: 'ADROIT',meaning:'SKILLFUL'},{ word: 'ADULATION',meaning:'EXCESSIVE FLATTERY (-)'},{ word: 'AESTHETIC',meaning:'ATTRACTIVE'},{ word: 'AFFINITY',meaning:'INCLINATION'},{ word: 'AGHAST',meaning:'HORRIFYING/SHOCKING'},{ word: 'AGILE',meaning:'FLEXIBLE'},{ word: 'Anatomical',meaning:'BODILY'},{ word: 'ANTICIPATES',meaning:'PREDICTION'},{ word: 'APPALLING',meaning:'HORRIFYING/SHOCKING'},{ word: 'APTITUDE',meaning:'INCLINATION'},{ word: 'AUGUR/AUGURY',meaning:'PREDICTION'},{ word: 'AVERT',meaning:'AVOID/DODGE'},{ word: 'BENT',meaning:'INCLINATION'},{ word: 'BUOYANT',meaning:'OPTIMISTIC'},{ word: 'CEREBRAL',meaning:'DETAILED KNOWLEDGE/INTELLECTUAL'},{ word: 'CIRCUITOUS',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'CIRCUMVENT',meaning:'AVOID/DODGE'},{ word: 'COMELY',meaning:'ATTRACTIVE'},{ word: 'Complicated',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'CONSUMMATE',meaning:'SKILLFUL'},{ word: 'CONVOLUTED',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'Corporeal',meaning:'BODILY'},{ word: 'DAUNTING',meaning:'CAUSING FEAR'},{ word: 'DEFLECT',meaning:'AVOID/DODGE'},{ word: 'DEFT',meaning:'SKILLFUL'},{ word: 'DEXTEROUS',meaning:'SKILLFUL'},{ word: 'DIDACTIC',meaning:'INSTRUCTIVE (-)'},{ word: 'DIFFUSE',meaning:'SPREAD'},{ word: 'DILATORY',meaning:'BE SLOW/WASTE TIME'},{ word: 'DISJOINTED',meaning:'SEPARATE/ X CONNECTED'},{ word: 'DISPOSED',meaning:'INCLINATION'},{ word: 'DISSEMINATE',meaning:'SPREAD'},{ word: 'EGREGIOUS',meaning:'HORRIFYING/SHOCKING'},{ word: 'ELUDE/ELUSIVE',meaning:'AVOID/DODGE'},{ word: 'Enlightenment',meaning:'DETAILED KNOWLEDGE/INTELLECTUAL'},{ word: 'ENRAGE',meaning:'VERY ANGRY'},{ word: 'ERUDITE',meaning:'DETAILED KNOWLEDGE/INTELLECTUAL'},{ word: 'EVADE / EVASIVE',meaning:'AVOID/DODGE'},{ word: 'FINESSE',meaning:'SKILLFUL'},{ word: 'FOREBODE',meaning:'SIGN (WARNING) (-)'},{ word: 'FORECAST',meaning:'PREDICTION'},{ word: 'FORESHADOW',meaning:'SIGN (WARNING) (-)'},{ word: 'FORESIGHT/ FORESEE',meaning:'PREDICTION'},{ word: 'FORETELL',meaning:'PREDICTION'},{ word: 'FUMBLE',meaning:'AWKWARD/CLUMSY'},{ word: 'FUME',meaning:'VERY ANGRY'},{ word: 'FUTILE',meaning:'INEFFECTIVE'},{ word: 'GAUCHE',meaning:'AWKWARD/CLUMSY'},{ word: 'GAWKY',meaning:'AWKWARD/CLUMSY'},{ word: 'GHASTLY',meaning:'HORRIFYING/SHOCKING'},{ word: 'GROSS',meaning:'HORRIFYING/SHOCKING'},{ word: 'GRUESOME',meaning:'HORRIFYING/SHOCKING'},{ word: 'HEINOUS',meaning:'HORRIFYING/SHOCKING'},{ word: 'HIDEOUS',meaning:'HORRIFYING/SHOCKING'},{ word: 'HORRENDOUS',meaning:'HORRIFYING/SHOCKING'},{ word: 'INCENSE',meaning:'VERY ANGRY'},{ word: 'INDIGNATION',meaning:'VERY ANGRY'},{ word: 'INEFFECTUAL',meaning:'INEFFECTIVE'},{ word: 'INFURIATE',meaning:'VERY ANGRY'},{ word: 'INTERTWINED',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'INTIMIDATE',meaning:'CAUSING FEAR'},{ word: 'INVOLVED',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'IRATE',meaning:'VERY ANGRY'},{ word: 'IRE',meaning:'VERY ANGRY'},{ word: 'LINGER',meaning:'BE SLOW/WASTE TIME'},{ word: 'LITHE',meaning:'FLEXIBLE'},{ word: 'LIVID',meaning:'VERY ANGRY'},{ word: 'MALINGER',meaning:'BE SLOW/WASTE TIME'},{ word: 'MEANDER',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'OBSEQUIOUS',meaning:'EXCESSIVE FLATTERY (-)'},{ word: 'OMINOUS',meaning:'SIGN (WARNING) (-)'},{ word: 'PEDANTIC',meaning:'INSTRUCTIVE (-)'},{ word: 'PENCHANT',meaning:'INCLINATION'},{ word: 'Physiological',meaning:'BODILY'},{ word: 'POLARIZE',meaning:'SEPARATE/ X CONNECTED'},{ word: 'PRECOCIOUS',meaning:'VERY TALENTED (CHILD)'},{ word: 'PREDILECTION',meaning:'INCLINATION'},{ word: 'PREDISPOSITION',meaning:'INCLINATION'},{ word: 'PREMONITION',meaning:'SIGN (WARNING) (-)'},{ word: 'PRESAGE',meaning:'PREDICTION'},{ word: 'PRESCIENCE',meaning:'PREDICTION'},{ word: 'PROCLIVITY',meaning:'INCLINATION'},{ word: 'PRODIGY',meaning:'VERY TALENTED (CHILD)'},{ word: 'PROFICIENT',meaning:'SKILLFUL'},{ word: 'PROGNOSIS',meaning:'PREDICTION'},{ word: 'PROMULGATE',meaning:'SPREAD'},{ word: 'PROPAGATE',meaning:'SPREAD'},{ word: 'PROPENSITY',meaning:'INCLINATION'},{ word: 'PROWESS',meaning:'SKILLFUL'},{ word: 'PUNDIT',meaning:'DETAILED KNOWLEDGE/INTELLECTUAL'},{ word: 'Refinement',meaning:'DETAILED KNOWLEDGE/INTELLECTUAL'},{ word: 'SANGUINE',meaning:'OPTIMISTIC'},{ word: 'SEGREGATE',meaning:'SEPARATE/ X CONNECTED'},{ word: 'SELF-FLATTERY',meaning:'EXCESSIVE FLATTERY (-)'},{ word: 'SHIRK',meaning:'AVOID/DODGE'},{ word: 'SINISTER',meaning:'CAUSING FEAR'},{ word: 'SKIRT',meaning:'AVOID/DODGE'},{ word: 'SUPPLE',meaning:'FLEXIBLE'},{ word: 'SWERVE',meaning:'AVOID/DODGE'},{ word: 'SYCOPHANT',meaning:'EXCESSIVE FLATTERY (-)'},{ word: 'TORTUOUS',meaning:'HAVING TWISTS/TURNS/COMPLEX'},{ word: 'UNGAINLY',meaning:'AWKWARD/CLUMSY'},{ word: 'UPBEAT',meaning:'OPTIMISTIC'},{ word: 'WRATH',meaning:'VERY ANGRY'},{ word: 'X EFFICACY (opposite)',meaning:'INEFFECTIVE'},{ word: 'X HEAD-ON (opposite)',meaning:'AVOID/DODGE'},{ word: 'X INEPT (opposite)',meaning:'SKILLFUL'},{ word: 'X INEVITABLE (opposite)',meaning:'AVOID/DODGE'},{ word: 'X MALADROIT (opposite)',meaning:'SKILLFUL'},{ word: 'X NEXUS (opposite)',meaning:'SEPARATE/ X CONNECTED'},{ word: 'X PESSIMISTIC (opposite)',meaning:'OPTIMISTIC'},{ word: 'X UNAVOIDABLE (opposite)',meaning:'AVOID/DODGE'},
            ],
            "Common Words II": [
                { word: 'PERSPICACIOUS', meaning: 'having a ready insight into and understanding of things' },
                { word: 'SAGACIOUS', meaning: 'having or showing keen mental discernment and good judgment' },
                { word: 'ASTUTE', meaning: 'having an ability to accurately assess situations or people' },
                { word: 'SHREWD', meaning: 'having or showing sharp powers of judgment' },
                { word: 'DISCERNING', meaning: 'having or showing good judgment' },
                { word: 'KEEN', meaning: 'having or showing eagerness or enthusiasm' },
                { word: 'SHARP', meaning: 'having a cutting edge or point' },
                { word: 'OBSTINATE', meaning: 'stubbornly refusing to change one\'s opinion' },
                { word: 'INTRANSIGENT', meaning: 'unwilling or refusing to change one\'s views' },
                { word: 'RECALCITRANT', meaning: 'having an obstinately uncooperative attitude' },
                { word: 'REFRACTORY', meaning: 'stubborn or unmanageable' },
                { word: 'CONTUMACIOUS', meaning: 'stubbornly or willfully disobedient to authority' },
            ],
            "Common Words III": [
                { word: 'LAUDATORY', meaning: 'expressing praise and commendation' },
                { word: 'PANEGYRIC', meaning: 'a public speech or published text in praise of someone' },
                { word: 'ENCOMIUM', meaning: 'a speech or piece of writing that praises someone highly' },
                { word: 'PLAUDIT', meaning: 'praise' },
                { word: 'ACCOLADE', meaning: 'an award or privilege granted as a special honor' },
                { word: 'COMMENDATION', meaning: 'praise' },
                { word: 'CASTIGATE', meaning: 'to reprimand severely' },
                { word: 'EXCORIATE', meaning: 'to criticize severely' },
                { word: 'LAMBASTE', meaning: 'to criticize harshly' },
                { word: 'CENSURE', meaning: 'to express severe disapproval of' },
                { word: 'REPROACH', meaning: 'to address someone in such a way as to express disapproval' },
                { word: 'REBUKE', meaning: 'to express sharp disapproval or criticism of' },
            ]
        };

        class FlashcardApp {
            constructor() {
                this.currentList = null;
                this.words = {};
                this.activeWords = [];
                this.currentWord = null;
                this.showingMeaning = false;
                this.maxActiveWords = 10;
                this.masteryThreshold = 3;
                this.listProgress = {};

                this.initializeElements();
                this.setupEventListeners();
                this.initializeListProgress();
                this.renderDashboard();
            }

            initializeElements() {
                this.dashboard = document.getElementById('dashboard');
                this.studyMode = document.getElementById('studyMode');
                this.deckGrid = document.getElementById('deckGrid');
                this.backBtn = document.getElementById('backBtn');
                this.flashcardSection = document.getElementById('flashcardSection');
                this.flashcard = document.getElementById('flashcard');
                this.wordDisplay = document.getElementById('wordDisplay');
                this.meaningDisplay = document.getElementById('meaningDisplay');
                this.definitionBtn = document.getElementById('definitionBtn');
                this.definitionContent = document.getElementById('definitionContent');
                this.knowBtn = document.getElementById('knowBtn');
                this.dontKnowBtn = document.getElementById('dontKnowBtn');
                this.noWordsMessage = document.getElementById('noWordsMessage');
                this.maxActiveWordsInput = document.getElementById('maxActiveWords');
                this.masteryThresholdInput = document.getElementById('masteryThreshold');

                // Progress elements
                this.masteredCount = document.getElementById('masteredCount');
                this.reviewingCount = document.getElementById('reviewingCount');
                this.learningCount = document.getElementById('learningCount');
                this.totalWords = document.getElementById('totalWords');
                this.totalWords2 = document.getElementById('totalWords2');
                this.totalWords3 = document.getElementById('totalWords3');
                this.masteredProgress = document.getElementById('masteredProgress');
                this.reviewingProgress = document.getElementById('reviewingProgress');
                this.learningProgress = document.getElementById('learningProgress');
            }

            setupEventListeners() {
                this.backBtn.addEventListener('click', () => this.showDashboard());
                this.flashcard.addEventListener('click', (e) => {
                    // Don't flip card if clicking the definition button
                    if (e.target !== this.definitionBtn) {
                        this.flipCard();
                    }
                });
                this.definitionBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.getDefinition();
                });
                this.knowBtn.addEventListener('click', () => this.handleAnswer(true));
                this.dontKnowBtn.addEventListener('click', () => this.handleAnswer(false));
                this.maxActiveWordsInput.addEventListener('change', (e) => {
                    this.maxActiveWords = parseInt(e.target.value);
                });
                this.masteryThresholdInput.addEventListener('change', (e) => {
                    this.masteryThreshold = parseInt(e.target.value);
                });
            }
            
            // Updated logic to handle flat list of word-meaning pairs
            initializeListProgress() {
                Object.keys(WORD_LISTS).forEach(listName => {
                    if (!this.listProgress[listName]) {
                        this.listProgress[listName] = {};
                        const wordObjects = WORD_LISTS[listName]; // This is now an array of {word, meaning}
                        
                        // Shuffle the list to ensure randomness from the start
                        const shuffledWords = this.shuffleArray(wordObjects);

                        shuffledWords.forEach(wordObj => {
                            const word = wordObj.word;
                            const meaning = wordObj.meaning;
                            // Use the word itself as the key
                            this.listProgress[listName][word] = {
                                word: word,
                                meaning: meaning,
                                correctCount: 0,
                                state: 'learning'
                            };
                        });
                    }
                });
            }

            renderDashboard() {
                this.deckGrid.innerHTML = '';

                Object.keys(WORD_LISTS).forEach(listName => {
                    const words = this.listProgress[listName];
                    const totalWords = Object.keys(words).length;
                    const masteredWords = Object.values(words).filter(w => w.state === 'mastered').length;
                    const progressPercent = totalWords > 0 ? (masteredWords / totalWords) * 100 : 0;

                    const deckCard = document.createElement('div');
                    deckCard.className = 'deck-card';
                    deckCard.innerHTML = `
                        <div class="deck-title">${listName}</div>
                        <div class="deck-progress">
                            <div class="progress-text">${masteredWords} of ${totalWords} words mastered</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                        </div>
                        <button class="practice-btn">Practice this deck ‚Üí</button>
                    `;

                    deckCard.addEventListener('click', () => this.startStudying(listName));
                    this.deckGrid.appendChild(deckCard);
                });
            }

            showDashboard() {
                this.dashboard.style.display = 'block';
                this.studyMode.style.display = 'none';
                this.renderDashboard(); // Update progress
            }

            startStudying(listName) {
                this.currentList = listName;
                this.words = { ...this.listProgress[listName] };
                this.dashboard.style.display = 'none';
                this.studyMode.style.display = 'block';

                this.updateActiveWords();
                this.updateProgress();
                this.showNextWord();
            }

            updateActiveWords() {
                const learningWords = this.shuffleArray(Object.values(this.words).filter(w => w.state === 'learning'));
                const reviewingWords = this.shuffleArray(Object.values(this.words).filter(w => w.state === 'reviewing'));
                const masteredWords = this.shuffleArray(Object.values(this.words).filter(w => w.state === 'mastered'));

                this.activeWords = [...reviewingWords];

                const remainingSlots = this.maxActiveWords - this.activeWords.length;
                if(remainingSlots > 0) {
                    const wordsToAdd = Math.min(remainingSlots, learningWords.length);
                    this.activeWords.push(...learningWords.slice(0, wordsToAdd));
                }
                
                // If there's still space and no learning words, pull from mastered for review
                if (this.activeWords.length < this.maxActiveWords && learningWords.length === 0) {
                    const masteredToAdd = this.maxActiveWords - this.activeWords.length;
                    this.activeWords.push(...masteredWords.slice(0, masteredToAdd));
                }
            }

            showNextWord() {
                // Refresh active words if the pool is empty but there are still words to learn/review
                if (this.activeWords.length === 0) {
                    this.updateActiveWords();
                }

                if (this.activeWords.length === 0) {
                    this.flashcardSection.style.display = 'none';
                    this.noWordsMessage.style.display = 'block';
                    return;
                }

                this.flashcardSection.style.display = 'block';
                this.noWordsMessage.style.display = 'none';

                let nextWord;
                // Simple random selection from the active pool
                if (this.activeWords.length === 1) {
                    nextWord = this.activeWords[0];
                } else {
                    do {
                        nextWord = this.activeWords[Math.floor(Math.random() * this.activeWords.length)];
                    } while (nextWord === this.currentWord && this.activeWords.length > 1);
                }

                this.currentWord = nextWord;
                this.showingMeaning = false;

                this.wordDisplay.textContent = this.currentWord.word;
                this.meaningDisplay.style.display = 'none';
                this.definitionContent.style.display = 'none';
                this.wordDisplay.style.display = 'block';
                this.knowBtn.style.display = 'none';
                this.dontKnowBtn.style.display = 'none';
            }

            flipCard() {
                if (!this.showingMeaning) {
                    this.showingMeaning = true;
                    this.wordDisplay.style.display = 'none';
                    this.meaningDisplay.style.display = 'block';
                    this.meaningDisplay.textContent = this.currentWord.meaning;
                    this.knowBtn.style.display = 'inline-block';
                    this.dontKnowBtn.style.display = 'inline-block';
                }
            }

            handleAnswer(correct) {
                if (!this.currentWord) return;

                if (correct) {
                    this.currentWord.correctCount++;

                    if (this.currentWord.state === 'learning') {
                        this.currentWord.state = 'reviewing';
                    } else if (this.currentWord.state === 'reviewing' && this.currentWord.correctCount >= this.masteryThreshold) {
                        this.currentWord.state = 'mastered';
                    } else if (this.currentWord.state === 'mastered' && this.currentWord.correctCount >= this.masteryThreshold) {
                        this.currentWord.correctCount = this.masteryThreshold; // Cap the count
                    }
                } else {
                    this.currentWord.correctCount = 0;
                    if (this.currentWord.state === 'mastered') {
                        this.currentWord.state = 'reviewing';
                    } else if (this.currentWord.state === 'reviewing') {
                        this.currentWord.state = 'learning';
                    }
                }

                // Update the master progress object
                this.listProgress[this.currentList][this.currentWord.word] = { ...this.currentWord };

                // Remove the answered word from the current active list to avoid repeats
                this.activeWords = this.activeWords.filter(w => w.word !== this.currentWord.word);

                this.updateProgress();
                this.showNextWord();
            }

            updateProgress() {
                const totalWords = Object.keys(this.words).length;
                const masteredWords = Object.values(this.words).filter(w => w.state === 'mastered').length;
                const reviewingWords = Object.values(this.words).filter(w => w.state === 'reviewing').length;
                const learningWords = Object.values(this.words).filter(w => w.state === 'learning').length;

                this.masteredCount.textContent = masteredWords;
                this.reviewingCount.textContent = reviewingWords;
                this.learningCount.textContent = learningWords;
                this.totalWords.textContent = totalWords;
                this.totalWords2.textContent = totalWords;
                this.totalWords3.textContent = totalWords;

                this.masteredProgress.style.width = totalWords > 0 ? `${(masteredWords / totalWords) * 100}%` : '0%';
                this.reviewingProgress.style.width = totalWords > 0 ? `${(reviewingWords / totalWords) * 100}%` : '0%';
                this.learningProgress.style.width = totalWords > 0 ? `${(learningWords / totalWords) * 100}%` : '0%';
            }

            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            async getDefinition() {
                if (!this.currentWord) return;

                const word = this.currentWord.word.toLowerCase();
                this.definitionContent.style.display = 'block';
                this.definitionContent.innerHTML = '<div class="definition-loading">Loading definition...</div>';

                try {
                    // Using the Free Dictionary API
                    const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);

                    if (!response.ok) {
                        throw new Error('Definition not found');
                    }

                    const data = await response.json();
                    const entry = data[0];

                    let definitionHtml = `<h4>${entry.word}</h4>`;

                    if (entry.phonetics && entry.phonetics[0] && entry.phonetics[0].text) {
                        definitionHtml += `<p><strong>Pronunciation:</strong> ${entry.phonetics[0].text}</p>`;
                    }

                    entry.meanings.forEach((meaning, index) => {
                        if (index < 2) { // Limit to first 2 meanings to avoid overflow
                            definitionHtml += `<p><strong>${meaning.partOfSpeech}:</strong> ${meaning.definitions[0].definition}</p>`;

                            if (meaning.definitions[0].example) {
                                definitionHtml += `<p><em>Example: "${meaning.definitions[0].example}"</em></p>`;
                            }
                        }
                    });

                    this.definitionContent.innerHTML = definitionHtml;

                } catch (error) {
                    // Fallback to a simpler definition or error message
                    this.definitionContent.innerHTML = `
                        <h4>${this.currentWord.word}</h4>
                        <p>Unable to fetch definition from dictionary API.</p>
                        <p><strong>Flashcard meaning:</strong> ${this.currentWord.meaning}</p>
                        <p><em>Try searching "${this.currentWord.word}" online for more detailed definitions.</em></p>
                    `;
                }
            }
        }

        // Initialize the app
        const app = new FlashcardApp();
    </script>
</body>

</html>
